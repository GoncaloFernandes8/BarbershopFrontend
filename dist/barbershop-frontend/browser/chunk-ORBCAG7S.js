import{a as w}from"./chunk-K3PE7NRC.js";import{c as D}from"./chunk-WTSW2KME.js";import{$ as g,A as v,D as o,G as y,Ia as I,K as m,N as p,P as h,Q as e,R as t,S as E,V as O,W as _,X as l,Z as i,_ as u,l as x,sa as M,t as f,ta as P,v as b,w as C,xa as S}from"./chunk-VTAVQ2BQ.js";function T(a,n){a&1&&(e(0,"span"),i(1,"\u{1F504} Atualizar"),t())}function z(a,n){a&1&&(e(0,"span"),i(1,"\u23F3 A carregar..."),t())}function A(a,n){a&1&&(e(0,"div",11),E(1,"div",12),e(2,"p"),i(3,"A carregar hist\xF3rico..."),t()())}function B(a,n){if(a&1){let r=O();e(0,"div",13)(1,"div",14),i(2,"\u{1F4C5}"),t(),e(3,"h3"),i(4,"Ainda n\xE3o tem marca\xE7\xF5es"),t(),e(5,"p",2),i(6,"Fa\xE7a a sua primeira marca\xE7\xE3o para ver o hist\xF3rico aqui."),t(),e(7,"button",6),_("click",function(){b(r);let c=l();return C(c.newAppointment())}),i(8," Fazer Primeira Marca\xE7\xE3o "),t()()}}function F(a,n){if(a&1&&(e(0,"span",31),i(1),t()),a&2){let r=l().$implicit,s=l(2);o(),g(" \xB7 ",s.formatPrice(s.getServiceById(r.serviceId).priceCents)," ")}}function H(a,n){if(a&1&&(e(0,"div",25)(1,"span",26),i(2,"Dura\xE7\xE3o:"),t(),e(3,"span",27),i(4),t()()),a&2){let r=l().$implicit,s=l(2);o(4),g("",s.getServiceById(r.serviceId).durationMin," minutos")}}function N(a,n){if(a&1&&(e(0,"div",25)(1,"span",26),i(2,"Notas:"),t(),e(3,"span",27),i(4),t()()),a&2){let r=l().$implicit;o(4),u(r.notes)}}function L(a,n){a&1&&(e(0,"div",32)(1,"button",33),i(2," \u{1F4DD} Editar "),t(),e(3,"button",34),i(4," \u274C Cancelar "),t()())}function R(a,n){if(a&1&&(e(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20),i(4),t(),e(5,"div",21),i(6),t()(),e(7,"div",22)(8,"span",23),i(9),t()()(),e(10,"div",24)(11,"div",25)(12,"span",26),i(13,"Servi\xE7o:"),t(),e(14,"span",27),i(15),m(16,F,2,1,"span",28),t()(),e(17,"div",25)(18,"span",26),i(19,"Barbeiro:"),t(),e(20,"span",27),i(21),t()(),m(22,H,5,1,"div",29)(23,N,5,1,"div",29),t(),m(24,L,5,0,"div",30),t()),a&2){let r,s,c=n.$implicit,d=l(2);o(4),u(d.formatDateTime(c.startsAt)),o(2),g("#",c.id.slice(0,8),""),o(2),h(d.getStatusClass(c.status)),o(),g(" ",d.getStatusText(c.status)," "),o(6),g(" ",((r=d.getServiceById(c.serviceId))==null?null:r.name)||"Servi\xE7o n\xE3o encontrado"," "),o(),p("ngIf",d.getServiceById(c.serviceId)),o(5),g(" ",((s=d.getBarberById(c.barberId))==null?null:s.name)||"Barbeiro n\xE3o encontrado"," "),o(),p("ngIf",d.getServiceById(c.serviceId)),o(),p("ngIf",c.notes),o(),p("ngIf",c.status==="CONFIRMED")}}function $(a,n){if(a&1&&(e(0,"div",15),m(1,R,25,11,"div",16),t()),a&2){let r=l();o(),p("ngForOf",r.appointments())("ngForTrackBy",r.trackByAppointmentId)}}function V(a,n){if(a&1&&(e(0,"div",35)(1,"div",36)(2,"h3"),i(3,"Resumo"),t(),e(4,"div",37)(5,"div",38)(6,"span",39),i(7),t(),e(8,"span",40),i(9,"Total de Marca\xE7\xF5es"),t()(),e(10,"div",38)(11,"span",39),i(12),t(),e(13,"span",40),i(14,"Conclu\xEDdas"),t()(),e(15,"div",38)(16,"span",39),i(17),t(),e(18,"span",40),i(19,"Pr\xF3ximas"),t()()()()()),a&2){let r=l();o(7),u(r.totalAppointments),o(5),u(r.completedAppointments),o(5),u(r.confirmedAppointments)}}var k=class a{bookingService=f(w);authService=f(D);router=f(I);loading=v(!0);appointments=v([]);services=v([]);barbers=v([]);ngOnInit(){this.loadData()}loadData(){this.loading.set(!0);let n=this.bookingService.getUserAppointments(),r=this.bookingService.getServices(),s=this.bookingService.getBarbers();n.pipe(x(()=>this.loading.set(!1))).subscribe(c=>{this.appointments.set(c)}),r.subscribe(c=>{this.services.set(c)}),s.subscribe(c=>{this.barbers.set(c)})}getServiceById(n){return this.services().find(r=>r.id===n)}getBarberById(n){return this.barbers().find(r=>r.id===n)}getStatusText(n){switch(n){case"CONFIRMED":return"Confirmada";case"COMPLETED":return"Conclu\xEDda";case"CANCELLED":return"Cancelada";case"NO_SHOW":return"N\xE3o compareceu";default:return"Pendente"}}getStatusClass(n){switch(n){case"CONFIRMED":return"status-confirmed";case"COMPLETED":return"status-completed";case"CANCELLED":return"status-cancelled";case"NO_SHOW":return"status-no-show";default:return"status-pending"}}formatDateTime(n){return new Date(n).toLocaleString("pt-PT",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}formatPrice(n){return(n/100).toLocaleString("pt-PT",{style:"currency",currency:"EUR"})}newAppointment(){this.router.navigate(["/marcacao"])}refresh(){this.loadData()}trackByAppointmentId(n,r){return r.id}get totalAppointments(){return this.appointments().length}get completedAppointments(){return this.appointments().filter(n=>n.status==="COMPLETED").length}get confirmedAppointments(){return this.appointments().filter(n=>n.status==="CONFIRMED").length}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=y({type:a,selectors:[["app-history"]],decls:16,vars:7,consts:[[1,"history"],[1,"header"],[1,"muted"],[1,"actions"],[1,"btn","ghost",3,"click","disabled"],[4,"ngIf"],[1,"btn","accent",3,"click"],["class","loading-container",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","appointments-list",4,"ngIf"],["class","summary",4,"ngIf"],[1,"loading-container"],[1,"spinner"],[1,"empty-state"],[1,"empty-icon"],[1,"appointments-list"],["class","appointment-card",4,"ngFor","ngForOf","ngForTrackBy"],[1,"appointment-card"],[1,"appointment-header"],[1,"appointment-date"],[1,"date-main"],[1,"appointment-id"],[1,"appointment-status"],[1,"status-badge"],[1,"appointment-details"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],["class","detail-price",4,"ngIf"],["class","detail-row",4,"ngIf"],["class","appointment-actions",4,"ngIf"],[1,"detail-price"],[1,"appointment-actions"],[1,"btn","small","ghost"],[1,"btn","small","error"],[1,"summary"],[1,"summary-card"],[1,"summary-stats"],[1,"stat"],[1,"stat-number"],[1,"stat-label"]],template:function(r,s){r&1&&(e(0,"section",0)(1,"div",1)(2,"h1"),i(3,"Hist\xF3rico de Marca\xE7\xF5es"),t(),e(4,"p",2),i(5,"Todas as suas marca\xE7\xF5es anteriores"),t(),e(6,"div",3)(7,"button",4),_("click",function(){return s.refresh()}),m(8,T,2,0,"span",5)(9,z,2,0,"span",5),t(),e(10,"button",6),_("click",function(){return s.newAppointment()}),i(11," \u2795 Nova Marca\xE7\xE3o "),t()()(),m(12,A,4,0,"div",7)(13,B,9,0,"div",8)(14,$,2,2,"div",9)(15,V,20,3,"div",10),t()),r&2&&(o(7),p("disabled",s.loading()),o(),p("ngIf",!s.loading()),o(),p("ngIf",s.loading()),o(3),p("ngIf",s.loading()),o(),p("ngIf",!s.loading()&&s.appointments().length===0),o(),p("ngIf",!s.loading()&&s.appointments().length>0),o(),p("ngIf",!s.loading()&&s.appointments().length>0))},dependencies:[S,M,P],styles:[".history[_ngcontent-%COMP%]{padding:var(--space-6) 0}.header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-4);margin-bottom:var(--space-8)}.header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:var(--space-3);flex-wrap:wrap}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--space-4);padding:var(--space-16) 0}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-muted);font-size:var(--font-size-lg)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--space-6);padding:var(--space-16) 0;text-align:center}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;opacity:.6}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--text-primary);font-size:var(--font-size-2xl);margin:0}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-muted);font-size:var(--font-size-lg);max-width:400px}.appointments-list[_ngcontent-%COMP%]{display:grid;gap:var(--space-4);margin-bottom:var(--space-8)}.appointment-card[_ngcontent-%COMP%]{background:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--radius-2xl);padding:var(--space-6);transition:all var(--transition-base)}.appointment-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg);border-color:var(--color-border-hover)}.appointment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:var(--space-4);gap:var(--space-4)}.appointment-date[_ngcontent-%COMP%]{flex:1}.date-main[_ngcontent-%COMP%]{font-size:var(--font-size-lg);font-weight:var(--font-weight-semibold);color:var(--text-primary);margin-bottom:var(--space-1)}.appointment-id[_ngcontent-%COMP%]{font-size:var(--font-size-sm);color:var(--text-muted);font-family:monospace}.appointment-status[_ngcontent-%COMP%]{flex-shrink:0}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:var(--space-1) var(--space-3);border-radius:var(--radius-full);font-size:var(--font-size-xs);font-weight:var(--font-weight-semibold);text-transform:uppercase;letter-spacing:.5px}.status-confirmed[_ngcontent-%COMP%]{background:var(--color-primary-light);color:var(--color-primary);border:1px solid var(--color-primary)}.status-completed[_ngcontent-%COMP%]{background:var(--status-success);color:#fff}.status-cancelled[_ngcontent-%COMP%]{background:var(--status-error);color:#fff}.status-no-show[_ngcontent-%COMP%]{background:var(--status-warning);color:#fff}.status-pending[_ngcontent-%COMP%]{background:var(--color-surface-hover);color:var(--text-muted);border:1px solid var(--color-border)}.appointment-details[_ngcontent-%COMP%]{display:grid;gap:var(--space-3)}.detail-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:120px 1fr;gap:var(--space-3);align-items:start}.detail-label[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:var(--font-size-sm);font-weight:var(--font-weight-medium)}.detail-value[_ngcontent-%COMP%]{color:var(--text-primary);font-size:var(--font-size-sm)}.detail-price[_ngcontent-%COMP%]{color:var(--color-primary);font-weight:var(--font-weight-semibold)}.appointment-actions[_ngcontent-%COMP%]{display:flex;gap:var(--space-2);margin-top:var(--space-4);padding-top:var(--space-4);border-top:1px solid var(--color-border)}.btn.error[_ngcontent-%COMP%]{background:var(--status-error);color:#fff;border:1px solid var(--status-error)}.btn.error[_ngcontent-%COMP%]:hover{background:#dc2626;border-color:#dc2626}.summary[_ngcontent-%COMP%]{margin-top:var(--space-8)}.summary-card[_ngcontent-%COMP%]{background:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--radius-2xl);padding:var(--space-6)}.summary-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 var(--space-4) 0;color:var(--text-primary);font-size:var(--font-size-xl)}.summary-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:var(--space-4)}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;padding:var(--space-4);background:var(--color-surface-hover);border-radius:var(--radius-xl);border:1px solid var(--color-border)}.stat-number[_ngcontent-%COMP%]{font-size:var(--font-size-3xl);font-weight:var(--font-weight-bold);color:var(--color-primary);line-height:1;margin-bottom:var(--space-1)}.stat-label[_ngcontent-%COMP%]{font-size:var(--font-size-sm);color:var(--text-muted);font-weight:var(--font-weight-medium)}@media (max-width: 768px){.header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{flex-direction:column}.appointment-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:var(--space-3)}.appointment-status[_ngcontent-%COMP%]{align-self:flex-start}.detail-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:var(--space-1)}.detail-label[_ngcontent-%COMP%]{font-weight:var(--font-weight-semibold)}.appointment-actions[_ngcontent-%COMP%]{flex-direction:column}.summary-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{k as HistoryComponent};

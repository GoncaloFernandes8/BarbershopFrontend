import{a as k,b as d,c as V,d as I,f as F,g as N,h as R,i as q,k as L,m as j}from"./chunk-WHF2TWKE.js";import{a as T}from"./chunk-JUGMSLXR.js";import"./chunk-IFE72Z7Y.js";import{$ as v,A as g,B as x,D as i,G as y,Ga as S,Ia as O,K as f,M as C,N as l,O as P,Q as r,R as t,S as c,V as w,W as u,X as p,Z as a,_ as E,t as b,ta as M,v as _,w as h,xa as A}from"./chunk-VTAVQ2BQ.js";function D(n,o){if(n&1&&(r(0,"p",6),a(1),t()),n&2){let e=p();i(),E(e.note())}}function G(n,o){if(n&1){let e=w();r(0,"div",7)(1,"button",8),u("click",function(){_(e);let m=p();return h(m.resendVerification())}),a(2),t(),r(3,"span",9),a(4),t()()}if(n&2){let e=p();i(),l("disabled",e.resending()),i(),v(" ",e.resending()?"A reenviar\u2026":"Reenviar email de verifica\xE7\xE3o"," "),i(2),v(" para ",e.pendingEmail()," ")}}function U(n,o){n&1&&(r(0,"div",22),a(1," Insere um email v\xE1lido. "),t())}function B(n,o){n&1&&(r(0,"div",22),a(1," M\xEDnimo 6 caracteres. "),t())}function J(n,o){if(n&1){let e=w();r(0,"form",10),u("ngSubmit",function(){_(e);let m=p();return h(m.submitLogin())}),r(1,"div",11)(2,"label",12),a(3,"Email"),t(),c(4,"input",13),f(5,U,2,0,"div",14),t(),r(6,"div",15)(7,"label",16),a(8," Palavra-passe "),r(9,"button",17),u("click",function(){_(e);let m=p();return h(m.showPwdLogin.set(!m.showPwdLogin()))}),c(10,"img",18),t()(),c(11,"input",19),f(12,B,2,0,"div",14),t(),r(13,"div",20)(14,"button",21),a(15),t()()()}if(n&2){let e=p();l("formGroup",e.loginForm),i(5),l("ngIf",e.lf.email.touched&&e.lf.email.invalid),i(4),C("aria-pressed",e.showPwdLogin())("aria-controls","lpass")("aria-label",e.showPwdLogin()?"Esconder palavra-passe":"Mostrar palavra-passe"),i(),l("src",e.showPwdLogin()?"assets/feliz.png":"assets/taparolho.png",x),i(),l("type",e.showPwdLogin()?"text":"password"),i(),l("ngIf",e.lf.password.touched&&e.lf.password.invalid),i(2),l("disabled",e.loading()),i(),v(" ",e.loading()?"A entrar\u2026":"Entrar"," ")}}function $(n,o){n&1&&(r(0,"div",22),a(1," Nome \xE9 obrigat\xF3rio. "),t())}function H(n,o){n&1&&(r(0,"div",22),a(1," N\xFAmero inv\xE1lido. "),t())}function K(n,o){n&1&&(r(0,"div",22),a(1," Insere um email v\xE1lido. "),t())}function Q(n,o){n&1&&(r(0,"div",22),a(1," M\xEDnimo 6 caracteres. "),t())}function W(n,o){if(n&1){let e=w();r(0,"form",10),u("ngSubmit",function(){_(e);let m=p();return h(m.submitRegister())}),r(1,"div",11)(2,"label",23),a(3,"Nome"),t(),c(4,"input",24),f(5,$,2,0,"div",14),t(),r(6,"div",11)(7,"label",25),a(8,"Telem\xF3vel"),t(),c(9,"input",26),f(10,H,2,0,"div",14),t(),r(11,"div",11)(12,"label",27),a(13,"Email"),t(),c(14,"input",28),f(15,K,2,0,"div",14),t(),r(16,"div",15)(17,"label",29),a(18," Palavra-passe "),r(19,"button",17),u("click",function(){_(e);let m=p();return h(m.showPwdReg.set(!m.showPwdReg()))}),c(20,"img",18),t()(),c(21,"input",30),f(22,Q,2,0,"div",14),t(),r(23,"div",20)(24,"button",21),a(25),t(),r(26,"button",31),u("click",function(){_(e);let m=p();return h(m.switch("login"))}),a(27,"J\xE1 tenho conta"),t()()()}if(n&2){let e=p();l("formGroup",e.registerForm),i(5),l("ngIf",e.rf.name.touched&&e.rf.name.invalid),i(5),l("ngIf",e.rf.phone.touched&&e.rf.phone.invalid),i(5),l("ngIf",e.rf.email.touched&&e.rf.email.invalid),i(4),C("aria-pressed",e.showPwdReg())("aria-controls","rpass")("aria-label",e.showPwdReg()?"Esconder palavra-passe":"Mostrar palavra-passe"),i(),l("src",e.showPwdReg()?"assets/feliz.png":"assets/taparolho.png",x),i(),l("type",e.showPwdReg()?"text":"password"),i(),l("ngIf",e.rf.password.touched&&e.rf.password.invalid),i(2),l("disabled",e.loading()),i(),v(" ",e.loading()?"A enviar\u2026":"Criar conta"," ")}}var z=class n{fb=b(L);auth=b(T);router=b(O);route=b(S);pendingEmail=g(null);resending=g(!1);activeTab=g("login");showPwdLogin=g(!1);showPwdReg=g(!1);loading=g(!1);note=g(null);loginForm=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]],remember:[!0]});registerForm=this.fb.group({name:["",[d.required,d.minLength(2)]],phone:["",[d.required,d.pattern(/^\+?\d[\d\s-]{7,}$/)]],email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]]});ngOnInit(){let o=this.route.snapshot.data.tab;o?this.activeTab.set(o):this.route.snapshot.queryParamMap.get("tab")==="register"&&this.activeTab.set("register")}switch(o){this.activeTab.set(o),this.note.set(null)}submitLogin(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}this.loading.set(!0);let{email:o,password:e}=this.loginForm.getRawValue();this.auth.login({email:o,password:e}).subscribe({next:()=>{this.loading.set(!1),this.router.navigateByUrl("/marcacao")},error:s=>{this.loading.set(!1),this.note.set(s?.error?.message??"Credenciais inv\xE1lidas.")}})}resendVerification(){let o=this.pendingEmail();o&&(this.resending.set(!0),this.auth.resendVerification(o).subscribe({next:()=>{this.resending.set(!1),this.note.set("Reenvi\xE1mos o email de verifica\xE7\xE3o. Verifica a tua caixa de entrada.")},error:()=>{this.resending.set(!1),this.note.set("N\xE3o foi poss\xEDvel reenviar agora. Tenta mais tarde.")}}))}submitRegister(){if(this.registerForm.invalid){this.registerForm.markAllAsTouched();return}this.loading.set(!0),this.auth.register(this.registerForm.getRawValue()).subscribe({next:()=>{this.note.set("Envi\xE1mos um email de confirma\xE7\xE3o. Abre o link para concluir o registo."),this.activeTab.set("login"),this.loading.set(!1)},error:o=>{this.note.set(o?.error?.message||"N\xE3o foi poss\xEDvel registar."),this.loading.set(!1)}})}get lf(){return this.loginForm.controls}get rf(){return this.registerForm.controls}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-auth"]],decls:10,vars:8,consts:[[1,"auth","card"],[1,"tabs"],[1,"tab",3,"click"],["class","muted small",4,"ngIf"],["class","resend",4,"ngIf"],["class","form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"muted","small"],[1,"resend"],["type","button",1,"btn","small",3,"click","disabled"],[1,"muted","small",2,"margin-left",".5rem"],[1,"form",3,"ngSubmit","formGroup"],[1,"field"],["for","lemail"],["id","lemail","type","email","formControlName","email","autocomplete","email","required",""],["class","error",4,"ngIf"],[1,"field","pwd"],["for","lpass",1,"pwd-label"],["type","button",1,"pwd-emoji-btn",3,"click"],["alt","",1,"pwd-icon",3,"src"],["id","lpass","formControlName","password","autocomplete","current-password","required","",3,"type"],[1,"actions"],["type","submit",1,"btn","accent",3,"disabled"],[1,"error"],["for","rname"],["id","rname","type","text","formControlName","name","autocomplete","name","required",""],["for","rphone"],["id","rphone","type","tel","formControlName","phone","autocomplete","tel","required",""],["for","remail"],["id","remail","type","email","formControlName","email","autocomplete","email","required",""],["for","rpass",1,"pwd-label"],["id","rpass","formControlName","password","autocomplete","new-password","required","",3,"type"],["type","button",1,"btn","ghost",3,"click"]],template:function(e,s){e&1&&(r(0,"section",0)(1,"div",1)(2,"button",2),u("click",function(){return s.switch("login")}),a(3,"Login"),t(),r(4,"button",2),u("click",function(){return s.switch("register")}),a(5,"Criar conta"),t()(),f(6,D,2,1,"p",3)(7,G,5,3,"div",4)(8,J,16,10,"form",5)(9,W,28,12,"form",5),t()),e&2&&(i(2),P("active",s.activeTab()==="login"),i(2),P("active",s.activeTab()==="register"),i(2),l("ngIf",s.note()),i(),l("ngIf",s.pendingEmail()),i(),l("ngIf",s.activeTab()==="login"),i(),l("ngIf",s.activeTab()==="register"))},dependencies:[A,M,j,F,k,V,I,q,N,R],styles:[".auth[_ngcontent-%COMP%]{max-width:640px;margin:1.2rem auto 0;padding:1.25rem}.tabs[_ngcontent-%COMP%]{display:flex;gap:.4rem;background:#0f1117;border:1px solid #2a3042;padding:.25rem;border-radius:12px;margin-bottom:.6rem}.tab[_ngcontent-%COMP%]{flex:1 1 0;padding:.6rem .8rem;border-radius:10px;border:0;cursor:pointer;color:#cbd4e6;background:transparent;font-weight:700}.tab.active[_ngcontent-%COMP%]{color:#0f1117;background:#c3ff5a}.form[_ngcontent-%COMP%]{display:grid;gap:.9rem;margin-top:.6rem}.field[_ngcontent-%COMP%]{display:grid;gap:.35rem}label[_ngcontent-%COMP%]{color:#cbd4e6}input[_ngcontent-%COMP%]{width:100%;padding:.85rem .95rem;border-radius:12px;border:1px solid #2a3042;background:#12141a;color:#e9eef7;line-height:1.2}.error[_ngcontent-%COMP%]{color:#ff6b6b;font-size:.9rem;margin-top:.2rem}.muted.small[_ngcontent-%COMP%]{font-size:.95rem}.actions[_ngcontent-%COMP%]{display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.2rem}.btn.ghost[_ngcontent-%COMP%]{background:transparent;border:1px solid #2a3042;color:#e9eef7}.pwd[_ngcontent-%COMP%]{position:relative}.pwd[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:3.9rem}.pwd-label[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.6rem}.pwd-emoji-btn[_ngcontent-%COMP%]{border:0;background:transparent;cursor:pointer;font-size:1.6rem;line-height:1;padding:.1rem .2rem;border-radius:8px}.pwd-emoji-btn[_ngcontent-%COMP%]:hover{transform:scale(1.06)}.pwd-emoji-btn[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--accent);outline-offset:2px}.pwd[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:.95rem}.eye[_ngcontent-%COMP%], .pwd[_ngcontent-%COMP%]   .pwd-emoji[_ngcontent-%COMP%]{display:none!important}@media (max-width: 380px){.pwd[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:3.4rem}.pwd-emoji-btn[_ngcontent-%COMP%]{width:36px;height:40px;font-size:1.45rem;right:.55rem}}.pwd-emoji-btn[_ngcontent-%COMP%]{border:0;background:transparent;padding:0;margin-left:.5rem;cursor:pointer;line-height:0;display:inline-flex;align-items:center}.pwd-icon[_ngcontent-%COMP%]{width:40px;height:40px;display:block}.resend[_ngcontent-%COMP%]{margin:.25rem 0 .5rem;display:flex;align-items:center;gap:.5rem}.btn.small[_ngcontent-%COMP%]{padding:.55rem .8rem;border-radius:10px;font-size:.95rem}"]})};export{z as AuthComponent};

import{a as c}from"./chunk-TV7SSJCI.js";import"./chunk-KLHZ4TTL.js";import{$ as B,Ca as V,D as u,Da as z,Ea as F,Fa as $,G as T,Ha as q,Ia as C,Ja as J,K as L,Ka as U,La as W,M as y,Ma as Y,N as b,Q as i,R as a,S as g,V as S,W as v,X as w,Y as m,Z as l,f as _,fa as P,j as H,k,m as M,ma as x,q as R,t as s,ta as N,v as f,w as h,xa as D,ya as O,z as I,za as j}from"./chunk-VTAVQ2BQ.js";var Z=()=>({exact:!0});function ee(e,r){e&1&&(i(0,"a",17),l(1,"Login"),a())}function te(e,r){if(e&1){let t=S();i(0,"button",18),v("click",function(){f(t);let o=w(),p=m(7);return o.logout(),h(o.closeMenu(p))}),l(1,"Sair"),a()}}var A=class e{year=new Date().getFullYear();router=s(C);el=s(I);auth=s(c);isAuthPage=!1;get isLoggedIn(){return!!this.auth.user}get userName(){return this.auth.user?.name??""}get isHome(){return this.router.url==="/"||this.router.url.startsWith("/?")}closeMenu(r){r&&(r.checked=!1)}ngOnInit(){this.router.events.pipe(H(r=>r instanceof $)).subscribe(()=>{let r=this.el.nativeElement.querySelector("#nav-toggle");r&&(r.checked=!1);let t=this.router.url;this.isAuthPage=t.startsWith("/login")||t.startsWith("/registar")})}logout(){this.auth.logout(),this.router.navigateByUrl("/")}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=T({type:e,selectors:[["app-root"]],decls:28,vars:6,consts:[["navToggler",""],[1,"header"],[1,"container","nav"],["routerLink","/",1,"brand"],["src","assets/logo-neon.gif","alt","Logo Barbearia","width","40","height","40",1,"brand-logo","animated"],["type","checkbox","id","nav-toggle","aria-label","Abrir menu",1,"nav-toggle"],["for","nav-toggle","aria-controls","nav-menu",1,"nav-burger"],["id","nav-menu",1,"nav-menu"],[1,"nav-links"],["routerLink","/","routerLinkActive","active",3,"click","routerLinkActiveOptions"],["routerLink","/servicos","routerLinkActive","active",3,"click"],["routerLink","/marcacao","routerLinkActive","active",3,"click"],[1,"auth-actions"],["routerLink","/login","class","btn accent small",4,"ngIf"],["class","btn logout",3,"click",4,"ngIf"],[1,"container"],[1,"footer"],["routerLink","/login",1,"btn","accent","small"],[1,"btn","logout",3,"click"]],template:function(t,n){if(t&1){let o=S();i(0,"header",1)(1,"nav",2)(2,"a",3),g(3,"img",4),i(4,"span"),l(5,"Barbearia"),a()(),g(6,"input",5,0),i(8,"label",6),g(9,"span")(10,"span")(11,"span"),a(),i(12,"div",7)(13,"div",8)(14,"a",9),v("click",function(){f(o);let d=m(7);return h(n.closeMenu(d))}),l(15,"In\xEDcio"),a(),i(16,"a",10),v("click",function(){f(o);let d=m(7);return h(n.closeMenu(d))}),l(17,"Servi\xE7os"),a(),i(18,"a",11),v("click",function(){f(o);let d=m(7);return h(n.closeMenu(d))}),l(19,"Marca\xE7\xE3o"),a()(),i(20,"div",12),L(21,ee,2,0,"a",13)(22,te,2,0,"button",14),a()()()(),i(23,"main",15),g(24,"router-outlet"),a(),i(25,"footer",16)(26,"div",15),l(27),a()()}if(t&2){let o=m(7);u(8),y("aria-expanded",o!=null&&o.checked?"true":"false"),u(6),b("routerLinkActiveOptions",P(5,Z)),u(7),b("ngIf",!n.isLoggedIn&&!n.isAuthPage),u(),b("ngIf",n.isLoggedIn),u(5),B(" \xA9 ",n.year," Barbearia \u2014 Rua Principal, 123 \xB7 (+351) 900 000 000 ")}},dependencies:[D,N,q,J,U],encapsulation:2})};var G=()=>{let e=s(c),r=s(C);return e.isApproved?!0:(r.navigate(["/login"]),!1)};var Q=[{path:"login",loadComponent:()=>import("./chunk-35SE2F7Q.js").then(e=>e.AuthComponent),title:"Login \xB7 Barbearia"},{path:"registar",loadComponent:()=>import("./chunk-35SE2F7Q.js").then(e=>e.AuthComponent),title:"Criar conta \xB7 Barbearia"},{path:"",loadComponent:()=>import("./chunk-FLMMUP2H.js").then(e=>e.HomeComponent),title:"Barbearia"},{path:"sucesso/:id",loadComponent:()=>import("./chunk-ECJUXT7S.js").then(e=>e.SuccessComponent),title:"Confirmado \xB7 Barbearia"},{path:"servicos",loadComponent:()=>import("./chunk-AZQQHLKR.js").then(e=>e.ServicesComponent),title:"Servi\xE7os \xB7 Barbearia"},{path:"marcacao",loadComponent:()=>import("./chunk-XUKVMSL6.js").then(e=>e.BookingComponent),canActivate:[G],title:"Marca\xE7\xE3o \xB7 Barbearia"},{path:"confirmar",loadComponent:()=>import("./chunk-R5ICQCBU.js").then(e=>e.ConfirmComponent),title:"Confirmar email"},{path:"**",loadComponent:()=>import("./chunk-O73RF54F.js").then(e=>e.NotFoundComponent),title:"N\xE3o encontrado"}];function re(e){let r=e,t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length,o=parseInt(e.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return t===Math.floor(t)&&t>=0&&t<=1?1:o===0&&t!==0&&t%1e6===0&&n===0||!(o>=0&&o<=5)?4:5}var K=["pt",[["AM","PM"],void 0,void 0],void 0,[["D","S","T","Q","Q","S","S"],["dom.","seg.","ter.","qua.","qui.","sex.","s\xE1b."],["domingo","segunda-feira","ter\xE7a-feira","quarta-feira","quinta-feira","sexta-feira","s\xE1bado"],["dom.","seg.","ter.","qua.","qui.","sex.","s\xE1b."]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],["janeiro","fevereiro","mar\xE7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]],void 0,[["a.C.","d.C."],void 0,["antes de Cristo","depois de Cristo"]],0,[6,0],["dd/MM/y","d 'de' MMM 'de' y","d 'de' MMMM 'de' y","EEEE, d 'de' MMMM 'de' y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}",void 0,void 0,void 0],[",",".",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4\xA0#,##0.00","#E0"],"BRL","R$","Real brasileiro",{AUD:["AU$","$"],BYN:[void 0,"\u0440."],JPY:["JP\xA5","\xA5"],PHP:[void 0,"\u20B1"],PTE:["Esc."],RON:[void 0,"L"],SYP:[void 0,"S\xA3"],THB:["\u0E3F"],TWD:["NT$"],USD:["US$","$"]},"ltr",re];var E=class e{authService=s(c);isRefreshing=!1;intercept(r,t){if(r.url.includes("/auth/"))return t.handle(r);let n=localStorage.getItem("auth_token");if(n){let o=r.clone({setHeaders:{Authorization:`Bearer ${n}`}});return t.handle(o).pipe(k(p=>p.status===401&&!this.isRefreshing?this.handle401Error(r,t):_(()=>p)))}return t.handle(r)}handle401Error(r,t){return this.isRefreshing?t.handle(r):(this.isRefreshing=!0,this.authService.refreshToken().pipe(M(()=>{this.isRefreshing=!1;let n=localStorage.getItem("auth_token"),o=r.clone({setHeaders:{Authorization:`Bearer ${n}`}});return t.handle(o)}),k(n=>(this.isRefreshing=!1,this.authService.logout(),_(()=>n)))))}static \u0275fac=function(t){return new(t||e)};static \u0275prov=R({token:e,factory:e.\u0275fac})};O(K);j(A,{providers:[{provide:x,useValue:"pt-PT"},W(Q,Y()),z(F()),{provide:V,useClass:E,multi:!0}]}).catch(e=>console.error(e));
